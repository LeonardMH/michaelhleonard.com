require 'html-proofer'
task :default => :test

task :serve do
    system("bundle exec jekyll serve")
end

task :build do
    system("bundle exec jekyll build")
end

task :deploy => :build do
    # when deploying to server, compress the build files with gulp
    system("gulp")

    command = [
        "rsync",
        "-rvz -e",
        "'ssh -p 2222'",
        "--delete",
        "_site/",
        "micha310@michaelhleonard.com:/home/micha310/public_html/"
    ]

    system(command.join(" "))
end

task :clobber do
    rm_rf "_site"
end

task :test => :build do
  options = {
      :assume_extension => true
  }

  HTMLProofer.check_directory("./_site", options).run
end
